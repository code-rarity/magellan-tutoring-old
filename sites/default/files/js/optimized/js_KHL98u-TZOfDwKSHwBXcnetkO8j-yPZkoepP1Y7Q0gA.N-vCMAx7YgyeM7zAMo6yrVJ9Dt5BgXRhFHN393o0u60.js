/* Source and licensing information for the line(s) below can be found at http://www.magellantutoring.com/core/modules/contextual/js/contextual.js. */
(function(t,e,a,o,l,c,n){var r=t.extend(a.contextual,{strings:{open:e.t('Open'),close:e.t('Close')}});var s=n.getItem('Drupal.contextual.permissionsHash'),i=a.user.permissionsHash;if(s!==i){if(typeof i==='string'){o.chain(n).keys().each(function(t){if(t.substring(0,18)==='Drupal.contextual.'){n.removeItem(t)}})};n.setItem('Drupal.contextual.permissionsHash',i)};function d(t){var n=t.parents('.contextual-region').eq(-1).find('.contextual');if(n.length<=1){return};var o=n.eq(0).offset().top,r=n.eq(1).offset().top;if(o===r){var e=n.eq(1),a=0,i=e.find('.trigger');i.removeClass('visually-hidden');a=e.height();i.addClass('visually-hidden');e.css({top:e.position().top+a})}};function u(n,o){var s=n.closest('.contextual-region'),i=e.contextual;n.html(o).addClass('contextual').prepend(e.theme('contextualTrigger'));var c='destination='+e.encodePath(e.url(a.path.currentPath));n.find('.contextual-links a').each(function(){var t=this.getAttribute('href'),e=t.indexOf('?')===-1?'?':'&';this.setAttribute('href',t+e+c)});var u=new i.StateModel({title:s.find('h2').eq(0).text().trim()});var l=t.extend({el:n,model:u},r);i.views.push({visual:new i.VisualView(l),aural:new i.AuralView(l),keyboard:new i.KeyboardView(l)});i.regionViews.push(new i.RegionView(t.extend({el:s,model:u},r)));i.collection.add(u);t(document).trigger('drupalContextualLinkAdded',{$el:n,$region:s,model:u});d(n)};e.behaviors.contextual={attach:function(a){var l=t(a),i=l.find('[data-contextual-id]').once('contextual-render');if(i.length===0){return};var d=[];i.each(function(){d.push({id:t(this).attr('data-contextual-id'),token:t(this).attr('data-contextual-token')})});var r=[],s=[];d.forEach(function(t){var e=n.getItem('Drupal.contextual.'+t.id);if(e&&e.length){window.setTimeout(function(){u(l.find('[data-contextual-id="'+t.id+'"]'),e)});return};r.push(t.id);s.push(t.token)});if(r.length>0){t.ajax({url:e.url('contextual/render'),type:'POST',data:{'ids[]':r,'tokens[]':s},dataType:'json',success:function(t){o.each(t,function(t,e){n.setItem('Drupal.contextual.'+e,t);if(t.length>0){i=l.find('[data-contextual-id="'+e+'"]');for(var a=0;a<i.length;a++){u(i.eq(a),t)}}})}})}}};e.contextual={views:[],regionViews:[]};e.contextual.collection=new l.Collection([],{model:e.contextual.StateModel});e.theme.contextualTrigger=function(){return'<button class="trigger visually-hidden focusable" type="button"></button>'};t(document).on('drupalContextualLinkAdded',function(t,n){e.ajax.bindAjaxLinks(n.$el[0])})})(jQuery,Drupal,drupalSettings,_,Backbone,window.JSON,window.sessionStorage);
/* Source and licensing information for the above line(s) can be found at http://www.magellantutoring.com/core/modules/contextual/js/contextual.js. */