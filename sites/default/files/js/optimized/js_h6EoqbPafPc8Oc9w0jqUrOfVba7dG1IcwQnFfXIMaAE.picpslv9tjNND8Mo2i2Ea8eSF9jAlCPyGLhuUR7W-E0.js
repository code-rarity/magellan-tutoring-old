/* Source and licensing information for the line(s) below can be found at http://www.magellantutoring.com/core/modules/tour/js/tour.js. */
(function(t,i,e,o){var r=decodeURI(window.location.search);e.behaviors.tour={attach:function(i){t('body').once('tour').each(function(){var s=new e.tour.models.StateModel();new e.tour.views.ToggleTourView({el:t(i).find('#toolbar-tab-tour'),model:s});s.on('change:isActive',function(e,i){t(o).trigger(i?'drupalTourStarted':'drupalTourStopped')}).set('tour',t(i).find('ol#tour'));if(/tour=?/i.test(r)){s.set('isActive',!0)}})}};e.tour=e.tour||{models:{},views:{}};e.tour.models.StateModel=i.Model.extend({defaults:{tour:[],isActive:!1,activeTour:[]}});e.tour.views.ToggleTourView=i.View.extend({events:{click:'onClick'},initialize:function(){this.listenTo(this.model,'change:tour change:isActive',this.render);this.listenTo(this.model,'change:isActive',this.toggleTour)},render:function(){this.$el.toggleClass('hidden',this._getTour().length===0);var t=this.model.get('isActive');this.$el.find('button').toggleClass('is-active',t).prop('aria-pressed',t);return this},toggleTour:function(){if(this.model.get('isActive')){var t=this._getTour();this._removeIrrelevantTourItems(t,this._getDocument());var o=this,i=e.t('Close');if(t.find('li').length){t.joyride({autoStart:!0,postRideCallback:function(){o.model.set('isActive',!1)},template:{link:'<a href="#close" class="joyride-close-tip" aria-label="'+i+'">&times;</a>',button:'<a href="#" class="button button--primary joyride-next-tip"></a>'}});this.model.set({isActive:!0,activeTour:t})}}
else{this.model.get('activeTour').joyride('destroy');this.model.set({isActive:!1,activeTour:[]})}},onClick:function(t){this.model.set('isActive',!this.model.get('isActive'));t.preventDefault();t.stopPropagation()},_getTour:function(){return this.model.get('tour')},_getDocument:function(){return t(o)},_removeIrrelevantTourItems:function(i,o){var s=!1,a=/tips=([^&]+)/.exec(r);i.find('li').each(function(){var e=t(this),i=e.attr('data-id'),r=e.attr('data-class');if(a&&!t(this).hasClass(a[1])){s=!0;e.remove();return};if(!i&&!r||i&&o.find('#'+i).length||r&&o.find('.'+r).length){return};s=!0;e.remove()});if(s){var n=i.find('li').length;if(!n){this.model.set({tour:[]})};i.find('li').each(function(i){var o=e.t('!tour_item of !total',{'!tour_item':i+1,'!total':n});t(this).find('.tour-progress').text(o)}).eq(-1).attr('data-text',e.t('End tour'))}}})})(jQuery,Backbone,Drupal,document);
/* Source and licensing information for the above line(s) can be found at http://www.magellantutoring.com/core/modules/tour/js/tour.js. */